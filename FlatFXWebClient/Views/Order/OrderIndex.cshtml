@model FlatFXWebClient.ViewModels.OrderViewModel
@using FlatFXCore.BussinessLayer;

@{
    ViewBag.Title = "Order Currency Exchange";
    string queryHeaderClass = (Model.WorkflowStage == 1) ? "active" : "disabled not-active";
    string confirmHeaderClass = (Model.WorkflowStage == 2) ? "active" : "disabled not-active";
    string summaryHeaderClass = (Model.WorkflowStage == 3) ? "active" : "disabled not-active";
    string panelClass = (Model.WorkflowStage == 2) ? "order-confirm" : "order-currency-exchange-stage";
    string panelHeader = (Model.WorkflowStage == 1) ? FlatFXResources.Resources.OrderHeader : ((Model.WorkflowStage == 2) ? @FlatFXResources.Resources.ConfirmYourOrder : @FlatFXResources.Resources.OrderSummary);
    string controllerAction = "OrderIndex";
    if (Model.WorkflowStage == 2)
    {
        controllerAction = "Confim";
    }
    bool officeHoursOn = true;
}
<div class="order-system-wrapper">
    <div ng-controller="OrderCurrencyExchange"
         ng-init="init(@Model.WorkflowStage, '@Html.Raw(ApplicationInformation.Instance.IsDemoUser)', '@TempData["Result"]', '@TempData["ErrorResult"]', @Model.AmountCCY1)"
         class="order-currency-exchange-main">
        @using (Html.BeginForm(controllerAction, "Order", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
        {
            <div class="col-xs-12 order-system-header">
                <span class="glyphicon glyphicon-resize-small order-system-icon"></span> Order System
            </div>

            @Html.AntiForgeryToken()
            @Html.HiddenFor(model => model.OrderKey)
            @Html.HiddenFor(model => model.WorkflowStage)
            @Html.HiddenFor(model => model.OrderId)

            if (ApplicationInformation.Instance.IsDemoUser)
            {
                <div class="col-xs-12 demoToLiveTrading">
                    <span class="demo-to-real-label">@FlatFXResources.Resources.DemoEnvAlert</span>
                    <a class="btn btn-success demo-to-real-button" href="@Url.Action("ConvertDemoToRealAccount", "Account")">@FlatFXResources.Resources.DemoEnvButtonTxt</a>
                </div>
            }

            if (Model.InvalidAccountReason != null && Model.InvalidAccountReason.Count > 0 && Model.InvalidAccountReason[0].Contains("Office Hours:"))
            {
                officeHoursOn = false;
                <h2 class="red">The order system is not available</h2>
                <h3 class="green">
                    <u>Office Hours (GMT +02:00):</u><br /><br />
                    Monday - Thursday: 8:00 - 23:00<br /><br />
                    Friday: 8:00 - 13:00<br />
                </h3>
            }

            if (officeHoursOn)
            {
                <div>
                    <div id="resultDiv" class="col-xs-12"></div>
                    <div class="col-xs-6 text-center">
                        @Html.Partial("~/Views/OrderBook/OrderBookIndex.cshtml")
                    </div>

                    <div class="col-xs-6 text-center">
                        <div class="panel-danger form-horizontal @panelClass">
                            <div class="panel-heading">
                                <h3 class="panel-title">@panelHeader</h3>
                                @if (Model.WorkflowStage == 2)
                                {
                                    <div>
                                        @Html.ValidationSummary("", new { @class = "text-danger" })
                                    </div>
                                }
                            </div>
                            <div class="panel-body">
                                <div class="col-xs-12 text-center">
                                    <div class="row form-group">
                                        <div class="col-xs-12">
                                            <ul class="nav nav-pills nav-justified thumbnail setup-panel">
                                                <li class="@queryHeaderClass">
                                                    <a href="" style="text-decoration: none;">
                                                        <h4 class="list-group-item-heading">
                                                            @if (Model.WorkflowStage > 1)
                                                            {
                                                                <span class="glyphicon glyphicon-ok green"></span>
                                                            }
                                                            1. @FlatFXResources.Resources.OrderStep1Header
                                                        </h4>
                                                        <p class="list-group-item-text">@FlatFXResources.Resources.SmplTradeStep1Desc</p>
                                                    </a>
                                                </li>
                                                <li class="@confirmHeaderClass">
                                                    <a href="" style="text-decoration: none;">
                                                        <h4 class="list-group-item-heading">
                                                            @if (Model.WorkflowStage > 2)
                                                            {
                                                                <span class="glyphicon glyphicon-ok green"></span>
                                                            }
                                                            2. @FlatFXResources.Resources.OrderStep2Header
                                                        </h4>
                                                        <p class="list-group-item-text">@FlatFXResources.Resources.OrderStep2Desc</p>
                                                    </a>
                                                </li>
                                                <li class="@summaryHeaderClass">
                                                    <a href="" style="text-decoration: none;">
                                                        <h4 class="list-group-item-heading">3. @FlatFXResources.Resources.OrderStep3Header</h4>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>

                                    @if (Model.WorkflowStage == 1)
                                    {
                                        <div>
                                            @Html.Partial("~/Views/Order/OrderCreation.cshtml", Model)
                                        </div>
                                    }
                                    else if (Model.WorkflowStage == 2)
                                    {
                                        <div>
                                            @Html.Partial("~/Views/Order/OrderConfirm.cshtml", Model)
                                        </div>
                                    }
                                    else
                                    {
                                        <div>
                                            @Html.Partial("~/Views/Order/OrderSummary.cshtml", Model)
                                        </div>
                                    }

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        }
    </div>
</div>